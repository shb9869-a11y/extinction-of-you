 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index 7932794c46662d5395edc16c8b18d54d14628141..06cef77a131723a44de733ff84b1240139b39ed4 100644
--- a/index.html
+++ b/index.html
@@ -1,47 +1,48 @@
 <!DOCTYPE html>
 <html lang="ko">
 <head>
 <meta charset="utf-8"/>
 <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
 <title>SLEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEP</title>
 
 <meta name="apple-mobile-web-app-capable" content="yes">
 <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
 <meta name="apple-mobile-web-app-title" content="SLEEEEEP">
 <meta name="theme-color" content="#000000">
 
 <style>
   :root{
     --appH: 100svh;
     --frame: clamp(16px, 4vmin, 40px);
     --ui-gap: 8px;
 
     --fs-body: clamp(12px, 2.2vmin, 16px);
     --fs-strong: clamp(14px, 2.8vmin, 20px);
     --fs-small: clamp(11px, 1.8vmin, 14px);
     --fs-name: clamp(16px,3.2vmin,22px);
+    --fs-intro: clamp(18px, 3.6vmin, 26px);
 
     --pad-btn-y: clamp(6px, 1.1vmin, 10px);
     --pad-btn-x: clamp(10px, 1.8vmin, 20px);
 
     --safe-t: env(safe-area-inset-top, 0px);
     --safe-b: env(safe-area-inset-bottom, 0px);
     --safe-l: env(safe-area-inset-left, 0px);
     --safe-r: env(safe-area-inset-right, 0px);
   }
 
   html,body{margin:0;height:var(--appH);background:#000;overflow:hidden;touch-action:manipulation}
   body{font-family:Impact,"Anton","Arial Black",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans KR",sans-serif;}
   .fade{opacity:0; transition:opacity 1800ms ease}
   .fade.show{opacity:1}
 
   #view{position:fixed;left:0;top:0;width:100%;height:var(--appH);display:block;z-index:0}
   #freezeLayer{position:fixed;inset:0;z-index:500;display:none}
 
   .frameBox{
     position:fixed;
     left:calc(var(--frame) + var(--safe-l));
     top:calc(var(--frame) + var(--safe-t));
     right:calc(var(--frame) + var(--safe-r));
     bottom:calc(var(--frame) + var(--safe-b));
     border:2px solid rgba(255,255,255,.22); pointer-events:none; z-index:50;
@@ -102,64 +103,71 @@
   #nameOverlay{position:fixed; inset:0; z-index:260; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.85); color:#fff;}
   #nameCard{ width:min(92vw,600px); text-align:center; font-family:"Courier New",ui-monospace,monospace; }
   #nameCard h2{ margin:0 0 12px 0; letter-spacing:.08em; font-size:var(--fs-name); font-weight:400; }
   #nick{ width:100%; padding:12px 14px; background:#000; border:1px solid #555; color:#fff; font-size:var(--fs-name); outline:none; }
   #nameRow{ display:flex; gap:10px; margin-top:12px; justify-content:center; }
   #nameRow .uiBtn{ padding:10px 14px; }
   #nameRow .uiBtn.flat{ font-family:"Courier New",ui-monospace,monospace; font-size:var(--fs-name); font-weight:400; }
 
   /* Preset */
   #preset{position:fixed;inset:0;z-index:250;background:#000;display:none;cursor:pointer}
   #presetCanvas{position:absolute;left:0;top:0;width:100%;height:100%}
 
   /* Welcome */
   #overlayWelcome{position:fixed;inset:0;z-index:220;display:none;align-items:center;justify-content:center;color:#fff;background:rgba(0,0,0,.55);padding:calc(20px + var(--safe-t)) 20px calc(20px + var(--safe-b)) 20px;}
   #welcomeCard{ text-align:center; max-width:min(92vw, 900px); }
   #welcomeCard .title{ font-size:clamp(32px, 12vmin, 120px); font-weight:900; letter-spacing:.04em; line-height:1.02; margin-bottom:8px; text-transform:uppercase; }
   #welcomeCard .title + .title{ margin-top:0; }
 
   /* Intro big title */
   #introBig{ position:fixed; inset:0; z-index:231; display:none; align-items:center; justify-content:center; pointer-events:none; }
   #introBigText{ color:#fff; font-weight:900; letter-spacing:.06em; font-size:clamp(28px, 11vmin, 110px); text-transform:uppercase; text-align:center; }
 
   /* Intro body (두 줄 구조) */
   #introOverlay{position:fixed; inset:0; z-index:230; display:none; align-items:center; justify-content:center; color:#fff; background:rgba(0,0,0,.35); padding:calc(24px + var(--safe-t)) calc(16px + var(--safe-r)) calc(20px + var(--safe-b)) calc(16px + var(--safe-l)); font-family:"Courier New",ui-monospace,monospace; overflow:hidden;}
   #introBox{ width:min(92vw, 860px); margin:0 auto; visibility:hidden; height:0; overflow:hidden; }
-  #introBox p{font-size:var(--fs-body);}
+  #introBox p{font-size:var(--fs-intro);}
 
   #introPrev{
     position:absolute; left:calc(var(--frame) + var(--safe-l) + 6px);
     top:calc(var(--frame) + var(--safe-t) + 4px);
     max-width:min(92vw, 860px);
-    font-size:var(--fs-body); line-height:1.85; text-align:left;
+    font-size:var(--fs-intro); line-height:1.85; text-align:left;
     opacity:0; transition:opacity 600ms ease;
     text-shadow:0 1px 2px rgba(0,0,0,.6);
   }
   #introPrev.show{ opacity:1; }
+  #introPrev,
   #introLive{
+    white-space:normal;
+    word-break:keep-all;
+    overflow-wrap:anywhere;
+  }
+  #introLive{
+    display:inline-block;
     max-width:min(92vw, 900px);
-    font-size:var(--fs-body); line-height:1.85; text-align:center;
+    font-size:var(--fs-intro); line-height:1.85; text-align:center;
     text-shadow:0 1px 2px rgba(0,0,0,.6);
   }
 
   #introCount{ position:absolute; bottom:calc(var(--frame) + var(--safe-b) + 8px); left:50%; transform:translateX(-50%); font-size:var(--fs-strong); }
 
   #titleScreen{ display:none; } /* 플래시/텍스트 연출 제거 */
 
   #firstSleep{ position:fixed; inset:0; z-index:235; display:none; align-items:center; justify-content:center; pointer-events:none; opacity:1; }
   #firstSleepText{ color:#fff; font-weight:900; letter-spacing:.06em; font-size:clamp(28px, 11vmin, 110px); text-transform:uppercase; }
 </style>
 </head>
 <body>
   <canvas id="view"></canvas>
   <canvas id="freezeLayer"></canvas>
   <div class="frameBox" aria-hidden="true"></div>
 
   <div class="controls" id="controls">
     <button class="uiBtn small" id="zoomOut">–</button>
     <div class="readout"><span id="zoomVal">1.0×</span></div>
     <button class="uiBtn small" id="zoomIn">+</button>
   </div>
   <button id="captureBtn" class="uiBtn small btn-capture">CAPTURE</button>
 
   <button id="docLauncher" class="uiBtn small">DOCUMENT</button>
   <button id="mapLauncher" class="uiBtn small">MAP</button>
@@ -202,111 +210,111 @@
   </div>
 
   <!-- Welcome -->
   <div id="overlayWelcome" class="fade">
     <div id="welcomeCard">
       <div class="credits" style="margin-bottom:12px;">SHB, KHJ, JYS, KTK, KCW, KJS, JMJ, PHY</div>
       <div class="title">SLEEEEEEEEEEEEEEEEEEEEEEEEEP,</div>
       <div class="title">SLEEEEEEEEEEEEEEEEEEEEEEEEEP</div>
       <button id="goIntro" class="uiBtn flat" type="button" style="margin-top:6px">PRESS HERE TO SLEEP</button>
     </div>
   </div>
 
   <!-- Intro big title -->
   <div id="introBig" class="fade"><div id="introBigText"></div></div>
 
   <!-- Intro body -->
   <div id="introOverlay" class="fade">
     <!-- 소스 텍스트(보이지 않음) -->
     <div id="introBox">
       <p>안녕하세요?</p>
       <p>작게 대답해주세요.</p>
       <p>안녕하세요?</p>
       <p>대답을 해주셔야 프로그램이 진행될 수 있습니다.</p>
       <p>안녕하세요?</p>
       <p>감사합니다.</p>
-      <p>지금 이 화면을 보고 있는 당신은 ____의 내면 세계를 탐험하는 탐험가입니다.</p>
-      <p>지금부터 우리는 주변의 소리에 귀를 기울이며</p>
-      <p>30분 간의 짧은 낮잠에 빠져볼 것입니다.</p>
+      <p>지금 이 화면을 보고 있는 당신은 _____의 내면 세계를 탐험하는 탐험가입니다.</p>
+      <p>지금부터 우리는 주변의 소리에 귀를 기울이며 30분 간의 짧은 낮잠에 빠져볼 것입니다.</p>
       <p>자, 천천히 공간을 거닐어보세요.</p>
       <p>무릎을 들고, 발을 앞으로 뻗어보세요.</p>
       <p>참 잘했어요.</p>
       <p>맞아요. 그래 맞아요. 우리는 늘 그랬어요.</p>
       <p>우리는 언제나 타자와 함께 존재해 왔습니다.</p>
       <p>가족, 친구, 교수님, 지나가는 그들, 그리고 당신과 처음 만나는 저도 우리는 늘 함께 존재해왔습니다</p>
       <p>그러나 어느 순간 ‘너’로 불리던 그들은 ‘그것’으로 전락했습니다</p>
       <p>이유는 아무도 몰라요. 그저 우리가 ‘너’들을 ‘그것’들로 부르기 시작한 것이죠.</p>
       <p>김춘추의 &lt;꽃&gt;이 떠오르네요.</p>
       <p>(진지한 톤으로) 내가 그의 이름을 불러주기 전에는 그는 다만 하나의 몸짓에 지나지 않았다.</p>
       <p>크으으으으으으....</p>
       <p>네. 각설하고.</p>
       <p>이제 우리는 어느 곳에서도 ‘너’를 찾아볼 수 없습니다.</p>
       <p>우리는 이제 ‘너’가 사라진 세상에 살아가고 있으니까요.</p>
       <p>그런 특정했던 ‘너’는 서서히 희미해지고 퇴색되고 잊혀지고 잃어지고 앓아가고 있습니다</p>
       <p>마치 꿈 속에서 만난 누군가가</p>
       <p>...</p>
       <p>그게 누구였지?</p>
       <p>...</p>
       <p>하고 떠오르지 않는 것처럼</p>
       <p>이곳은 바로 ‘너’가 사라진 공간</p>
       <p>‘너’가 제거된, 제거해버린</p>
-      <p>____의 내면 세계입니다</p>
-      <p>그리고 당신은 지금 이 순간 ____의 내면 세계로 발을 디딥니다</p>
+      <p>_____의 내면 세계입니다</p>
+      <p>그리고 당신은 지금 이 순간 _____의 내면 세계로 발을 디딥니다</p>
       <p>두 번의 심호흡을 하기도 하면서,</p>
       <p>후 --</p>
       <p>하,</p>
       <p>후 ....</p>
       <p>하 ~</p>
       <p>이제 눈으로 감고,</p>
       <p>천천히 수면 아래로 내려갑니다.</p>
       <p>귀를 기울여 ‘보세요’</p>
       <p>내면의 미로를 탐험하여 사라진 ‘너’의 소리에</p>
       <p>말이 길었습니다. 잠시 후에 만나요.</p>
     </div>
 
     <!-- 두 줄 출력 영역 -->
     <div id="introPrev" aria-live="polite"></div>
     <div id="introLive" aria-live="polite"></div>
     <div id="introCount" aria-live="polite"></div>
   </div>
 
   <div id="firstSleep"><div id="firstSleepText">THE FIRST SLEEP</div></div>
 
 <script>
 (() => {
   /* Manifest */
   (function injectManifest(){
     const manifest = {"name":"SLEEEEEP","short_name":"SLEEEEEP","display":"standalone","start_url":"./","background_color":"#000","theme_color":"#000","icons":[]};
     const url = URL.createObjectURL(new Blob([JSON.stringify(manifest)], {type:"application/manifest+json"}));
     const link = document.createElement('link'); link.rel='manifest'; link.href=url; document.head.appendChild(link);
   })();
 
   const FADE = 1800;
   const sleep = ms => new Promise(r=>setTimeout(r,ms));
   const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));
   const map=(v,inMin,inMax,outMin,outMax)=>outMin+(outMax-outMin)*((v-inMin)/(inMax-inMin));
   const qs = s => document.querySelector(s);
+  const nextFrame = () => new Promise(resolve=>requestAnimationFrame(()=>resolve()));
 
   function fadeShow(el, dur=FADE, display='flex'){
     el.style.display=display; el.style.opacity='0';
     el.style.transition=`opacity ${dur}ms ease`;
     requestAnimationFrame(()=> el.style.opacity='1');
   }
   function fadeHide(el, dur=FADE){
     el.style.transition=`opacity ${dur}ms ease`;
     el.style.opacity='0';
     setTimeout(()=>{ el.style.display='none'; }, dur);
   }
 
   function setAppH(){ document.documentElement.style.setProperty('--appH', window.innerHeight + 'px'); }
   setAppH(); addEventListener('resize', setAppH, {passive:true});
   if (window.visualViewport){ visualViewport.addEventListener('resize', ()=>setTimeout(setAppH,50)); }
 
   /* ====== 가로 전용 ====== */
   const rotateOverlay = document.getElementById('rotateOverlay');
   function isPortrait(){
     const vv = window.visualViewport;
     const w = vv ? vv.width : innerWidth;
     const h = vv ? vv.height : innerHeight;
     const m = window.matchMedia && window.matchMedia("(orientation: portrait)");
     return (m && m.matches) || (h > w);
   }
@@ -430,51 +438,51 @@
         facingMode:{ideal:'environment'},
         width:{min:1280, ideal:1920},
         height:{min:720,  ideal:1080},
         aspectRatio:{ideal:16/9}
       },
       audio:{echoCancellation:true, noiseSuppression:true, autoGainControl:false}
     })
     .then(s=>{
       s.getTracks().forEach(t=>t.stop());
       camPermGranted = true;
     })
     .catch(err=>{ console.warn('permission error:', err); })
     .finally(()=>{
       fadeHide(overlay, FADE);
       Ambient.start(0.8, 1.0);
       fadeShow(nameOverlay, FADE);
       setTimeout(()=>nickInput && nickInput.focus && nickInput.focus(), 60);
     });
   }
   ['click','touchstart','pointerdown'].forEach(type=>{
     permBtn.addEventListener(type, immediateGestureStart, {passive:false});
     overlayEl.addEventListener(type, immediateGestureStart, {passive:false});
   });
 
   /* Name → Preset */
-  let displayName = 'YOU';
+  let displayName = '____';
   async function acceptName(){
     const v = (nickInput.value||'').trim();
     if(v.length>0){ displayName = v; }
     await ensureResumed();
     playWoongClick();
     fadeHide(nameOverlay, FADE);
     showPreset();
   }
   nameSubmit.addEventListener('click', acceptName, {passive:true});
   nickInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ acceptName(); }});
 
   /* ====== Camera 가로 강제 ====== */
   async function enforceLandscapeConstraints(){
     try{
       if(!camStream) return;
       const track = camStream.getVideoTracks()[0];
       if(!track) return;
       const s = track.getSettings ? track.getSettings() : {};
       const inLandscape = matchMedia('(orientation: landscape)').matches;
       if(inLandscape && s.height && s.width && s.height > s.width){
         await track.applyConstraints({
           advanced:[ { aspectRatio: 16/9 }, { width:{min:1280} }, { height:{max:1080} } ]
         }).catch(()=>{});
       }
       const s2 = track.getSettings ? track.getSettings() : {};
@@ -569,100 +577,110 @@
     fadeShow(welcome, FADE);
   }, {passive:true});
 
   /* Intro 타이핑 — 현재 문장 + 직전 문장만 노출 */
   function captureIntroTexts(){
     const els = Array.from(document.querySelectorAll('#introBox p'));
     return els.map(el=> (el.textContent||'').trim()).filter(Boolean);
   }
   async function typeSentenceTo(el, sentence, speed=38){
     el.textContent='';
     for(let i=0;i<sentence.length;i++){
       el.textContent += sentence[i];
       if(/\S/.test(sentence[i])) typeTick();
       await sleep(speed);
     }
   }
   async function showIntroFlow(){
     introBigText.textContent='';
     fadeShow(introBig, FADE, 'flex');
     await typeSentenceTo(introBigText, 'INTRODUCTION', 45);
     await sleep(1000);
     fadeHide(introBig, FADE);
 
     fadeShow(intro, FADE, 'flex');
 
-    let left = 50; introCount.textContent = `HAVE A NICE SLEEP IN ${left}s`;
-    const iv = setInterval(()=>{
-      left = Math.max(0, left-1);
-      introCount.textContent = `HAVE A NICE SLEEP IN ${left}s`;
-      countdownTick(left);
-      if(left<=0){ clearInterval(iv); startTransition(); }
-    },1000);
+    introCount.textContent = '';
+    introPrev.textContent = '';
+    introPrev.classList.remove('show');
+    introLive.textContent = '';
 
-    const lines = captureIntroTexts().map(l=>l.replaceAll('____', displayName));
+    const lines = captureIntroTexts().map(l=>l.split('____').join(displayName));
     let prevText = '';
     for(const line of lines){
       if(prevText){
         introPrev.textContent = prevText;
         introPrev.classList.add('show');
       }
       await typeSentenceTo(introLive, line, 38);
       await sleep(1800);
       prevText = line;
     }
+
+    await sleep(400);
+    let left = 10;
+    introCount.textContent = `HAVE A NICE SLEEP IN ${left}s`;
+    countdownTick(left);
+    const iv = setInterval(()=>{
+      left = Math.max(0, left-1);
+      introCount.textContent = `HAVE A NICE SLEEP IN ${left}s`;
+      countdownTick(left);
+      if(left<=0){ clearInterval(iv); startTransition(); }
+    },1000);
   }
   document.getElementById('goIntro').addEventListener('click', ()=>{ ensureResumed().then(()=>{ playWoongClick(); fadeHide(welcome, FADE); showIntroFlow(); }); }, {passive:true});
 
   /* 8-minute timer */
   let eightTimer = null, eightLeft = 8*60;
   function formatMMSS(s){ const m=Math.floor(s/60), ss=(s%60).toString().padStart(2,'0'); return `${m.toString().padStart(2,'0')}:${ss}`; }
   function startEightTimer(){
     eightLeft = 8*60;
     runTimer.textContent = formatMMSS(eightLeft);
     runTimer.style.display='block';
     if(eightTimer) clearInterval(eightTimer);
     eightTimer = setInterval(()=>{
       eightLeft = Math.max(0, eightLeft-1);
       runTimer.textContent = formatMMSS(eightLeft);
       if(eightLeft<=0){ clearInterval(eightTimer); }
     },1000);
   }
 
   /* Transition — FIRST SLEEP 단순 연출(버징 제거), BGM 페이드아웃 + Mic FX 페이드인 */
   async function startTransition(){
     fadeHide(intro, FADE);
 
     // FIRST SLEEP 표시
     firstSleep.style.display='flex';
     firstSleep.style.opacity='1';
+    await nextFrame();
     await ensureResumed();
     startEightTimer();
 
     // UI 노출
-    document.getElementById('controls').classList.add('show');
-    document.getElementById('captureBtn').classList.add('show');
+    await nextFrame();
+    controls.classList.add('show');
+    captureBtn.classList.add('show');
 
     // 앰비언스 4초 페이드아웃 + 마이크 4초 페이드인(동시)
     Ambient.stop(4.0);
     await startMicFXFadeIn(4.0);
 
     // 텍스트 서서히 사라짐
     await sleep(1100);
     firstSleep.style.transition='opacity 8000ms ease';
     firstSleep.style.opacity='0';
     await sleep(8200);
     firstSleep.style.display='none';
     firstSleep.style.transition='';
 
     // 캐릭터 등장(페이드 인)
     beginCharacter(true);
   }
 
   /* Ambient / Mic FX / Camera / Character — 이하 동일 (생략 없이 포함) */
 
   const Ambient = (() => {
     let ctx, master, delay, fb, hp, lp, mix, busGain, running=false, loops=[];
     function midi(n){ return 440 * Math.pow(2, (n-69)/12); }
     function makeBus(){
       ctx = audioCtx || new (window.AudioContext||window.webkitAudioContext)();
       master = ctx.createGain(); master.gain.value = 0.0001;
@@ -1005,82 +1023,90 @@
     if(capturing) return;
     if(!vctx || !pctx) return;
 
     const W=view.width/(window.devicePixelRatio||1), H=view.height/(window.devicePixelRatio||1);
     const PW=proc.width, PH=proc.height;
 
     if(warmupFrames>0){ resizeCam(); warmupFrames--; }
 
     pctx.fillStyle='rgba(0,0,0,.14)'; pctx.fillRect(0,0,PW,PH);
 
     if(camVideo && metaReady && camVideo.readyState>=2){
       drawBestCover(pctx, camVideo, W, H, PW, PH);
       const frame=pctx.getImageData(0,0,PW,PH),d=frame.data;
       for(let i=0;i<d.length;i+=4){const g=(0.299*d[i]+0.587*d[i+1]+0.114*d[i+2])|0; d[i]=d[i+1]=d[i+2]=g;}
       pctx.putImageData(frame,0,0);
     }
 
     vctx.imageSmoothingEnabled = false;
     vctx.drawImage(proc,0,0,W,H);
 
     if(charActive){ drawCharacter(W,H); }
   }
 
   /* Capture (픽셀화→소멸) */
   let captureAnimating = false;
-  document.getElementById('captureBtn').addEventListener('click', ()=>{
+  captureBtn.addEventListener('click', ()=>{
     if(captureAnimating) return;
     playWoongClick();
     captureAnimating = true;
 
     capturing = true;
     const cssW = view.clientWidth, cssH = view.clientHeight;
     freezeLayer.width = cssW; freezeLayer.height = cssH;
-    const fx = freezeLayer.getContext('2d');
-    fx.imageSmoothingEnabled = false;
-    fx.drawImage(view, 0, 0, view.width, view.height, 0, 0, cssW, cssH);
+    const displayCtx = freezeLayer.getContext('2d');
+    displayCtx.imageSmoothingEnabled = false;
+    freezeLayer.style.transition='';
+    freezeLayer.style.opacity='0';
     freezeLayer.style.display='block';
-    freezeLayer.style.opacity='1';
-
-    setTimeout(()=>{
-      const W = cssW, H = cssH;
-      let px = 1.0;
-      const step = 1.015;
-      const off = document.createElement('canvas');
-      const oc = off.getContext('2d');
-      const fx2 = freezeLayer.getContext('2d');
-
-      function anim(){
-        if(px > 420){
-          freezeLayer.style.transition='opacity 2000ms ease';
-          freezeLayer.style.opacity='0';
-          setTimeout(()=>{
-            freezeLayer.style.display='none';
-            freezeLayer.style.transition='';
-            capturing = false;
-            captureAnimating = false;
-          }, 2020);
-          return;
-        }
-        const w = Math.max(1, Math.floor(W/px));
-        const h = Math.max(1, Math.floor(H/px));
-        off.width = w; off.height = h;
-        oc.imageSmoothingEnabled=false;
-        oc.drawImage(freezeLayer,0,0,W,H,0,0,w,h);
-        fx2.clearRect(0,0,W,H);
-        fx2.imageSmoothingEnabled=false;
-        fx2.globalAlpha = 1.0;
-        fx2.drawImage(off,0,0,w,h,0,0,W,H);
-        px = px * step + 0.35;
-        requestAnimationFrame(anim);
+
+    const snapshot = document.createElement('canvas');
+    snapshot.width = cssW; snapshot.height = cssH;
+    const snapCtx = snapshot.getContext('2d');
+    snapCtx.imageSmoothingEnabled = false;
+    snapCtx.drawImage(view, 0, 0, view.width, view.height, 0, 0, cssW, cssH);
+
+    const off = document.createElement('canvas');
+    const oc = off.getContext('2d');
+    let px = 2.4;
+    const step = 1.015;
+    let revealed = false;
+
+    function anim(){
+      if(px > 420){
+        freezeLayer.style.transition='opacity 2000ms ease';
+        freezeLayer.style.opacity='0';
+        setTimeout(()=>{
+          freezeLayer.style.display='none';
+          freezeLayer.style.transition='';
+          capturing = false;
+          captureAnimating = false;
+        }, 2020);
+        return;
       }
-      anim();
-    }, 100);
+      const w = Math.max(1, Math.floor(cssW/px));
+      const h = Math.max(1, Math.floor(cssH/px));
+      off.width = w; off.height = h;
+      oc.imageSmoothingEnabled=false;
+      oc.clearRect(0,0,w,h);
+      oc.drawImage(snapshot,0,0,cssW,cssH,0,0,w,h);
+      displayCtx.clearRect(0,0,cssW,cssH);
+      displayCtx.imageSmoothingEnabled=false;
+      displayCtx.globalAlpha = 1.0;
+      displayCtx.drawImage(off,0,0,w,h,0,0,cssW,cssH);
+      if(!revealed){
+        freezeLayer.style.opacity='1';
+        revealed = true;
+      }
+      px = px * step + 0.35;
+      requestAnimationFrame(anim);
+    }
+    requestAnimationFrame(anim);
   });
 
   /* 시작 */
   window.addEventListener('load', ()=>{});
 
 })();
 </script>
 </body>
 </html>
\ No newline at end of file
 
EOF
)
