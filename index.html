// 1. 프리셋 애니메이션 속도 감소 (initSaver 함수 내)
vx:(Math.random()*0.6+0.15)*(Math.random()<.5?-1:1),  // 속도 절반 감소
vy:(Math.random()*0.6+0.15)*(Math.random()<.5?-1:1),

// 2. CSS 수정 (style 태그 내)
#welcomeCard .title {
  /* ... 기존 속성 ... */
  white-space:normal;  /* nowrap에서 변경 */
  word-break:keep-all;
  max-width:100%;
  overflow:hidden;
}

// 3. skipBtn 핸들러 수정 (기존 skipBtn.addEventListener 부분을 완전히 대체)
skipBtn.addEventListener('click', async ()=>{
  await ensureResumed();
  await playWoongClick();

  if(stage === 'intro'){
    fadeHide(introDialogue, 300);
    introWalking=false;
    showIntroLayer=false;
    await sleep(350);
    await playTduung();
    startIntroToFirstSleepSequence();
  }else if(stage === 'first'){
    if(mainTimer) clearInterval(mainTimer);
    timerFinished = true;
    await onFirstSleepTimerEnd();
  }else if(stage === 'second'){
    stopSecondBell();
    if(secondTimer) clearInterval(secondTimer);
    runTimer.style.display='none';
    await startThirdSleepSequence();
  }else if(stage === 'thirdIntro' || stage === 'game'){
    // 3장 타이틀이나 게임 화면에서 SKIP 시 바로 게임 시작 또는 엔딩
    goToSleepCity();
  }
}, {passive:true});

// 4. goToSleepCity 함수를 페이지 이동 대신 오버레이로 변경
function goToSleepCity(){
  // ... 기존 cleanup 코드 유지 ...
  
  // 페이지 이동 대신 게임 오버레이 표시
  const gameUI = document.createElement('div');
  gameUI.id = 'gameUI';
  gameUI.style.cssText = `
    position:fixed; inset:0; background:#000; z-index:2000;
    display:flex; align-items:center; justify-content:center;
    color:var(--accent); font-family:"Press Start 2P",monospace;
  `;
  gameUI.innerHTML = `
    <div style="text-align:center;">
      <h2 style="font-size:clamp(24px, 6vmin, 48px); margin-bottom:20px;">SLEEP CITY</h2>
      <button id="skipFromGame" class="uiBtn small">SKIP TO ENDING</button>
    </div>
  `;
  document.body.appendChild(gameUI);
  
  document.getElementById('skipFromGame').addEventListener('click', ()=>{
    document.body.removeChild(gameUI);
    // 엔딩 시퀀스 시작 (사용자가 구현 필요)
    console.log('Skip to ending sequence');
  });
}
